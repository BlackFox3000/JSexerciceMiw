<input type="button" onclick="exo1()" value="exo1">
<input type="button" onclick="exo2()" value="exo2">
<input type="button" onclick="exo3()" value="exo3">
<input type="button" onclick="exo3_0()" value="exo3-0">
<input type="button" onclick="exo4()" value="exo4">
<input type="button" onclick="exo5()" value="exo5">
<button><a href="TP/index.html" style="display: block; width: 100%">TP</a></button>

<script>
    
    function exo1(){
    console.log("début des requêtes Asynchrones");
    // Simulation d'une requête A asynchrone avec setTimeout
    setTimeout( () =>{
        let a=Math.random();
        if (a >0.5 ) console.log (`Requête Asynchrone A bien terminée le résultat de a = ${a}`);
        else console.log ('Requête Asynchrone A mal terminée');
    }, 5000);
    console.log("…..requête Asynchrone A en cours d'exécution");
    // simulation d'une requête B asynchrone avec setTimeout
    setTimeout( () =>{
        let b=Math.random();
        if (b >0.5 ) console.log (`Requete Asynchrone bien terminée le résultat de b = ${b}`);
        else console.log('Requete Asynchrone B mal terminée');
    }, 3000);

    console.log("…..requete Asynchrone B en cours d'exécution");
    }
    
    function exo2() {
        console.log("début des requêtes Asynchrone");
        // simulation d'une requête A asynchrone avec setTimeout
        setTimeout( () =>{
            var a=Math.random();
            if (a >0.5 ) console.log (`Requête Asynchrone bien terminée le résultat de a = ${a}`);
            else console.log ('Requête Asynchrone A mal terminée')
        }, 5000);
        alert(` a = ${a}`)
        2
        // simulation d'une requête B asynchrone avec setTimeout
        setTimeout( () =>{
            var b=Math.random();
            if (b >0.5 ) console.log (`Requête Asynchrone bien terminée le résultat de b = ${b}`);
            else console.log('Requête Asynchrone B mal terminée')
        }, 3000);

        alert(` b = ${b}`) 
    }
    
    function exo3() {
        function asynchrone(resolve,reject,d){
            // simulation d'une requête A asynchrone avec setTimeout
            setTimeout( ()=>{
                let a=Math.random();
                if (a >d ) resolve(a);
                else reject(a)
            }, 3000);
        };
        console.log("début des requêtes Asynchrone")
        asynchrone(
            (x)=>{ console.log(`1ère requête asynchrone réussie résultat= ${x}`)},
            (x)=>{console.log(`1ère requête asynchrone échouée résultat= ${x}`)},
            0.1
        );
        asynchrone(
            (x)=>{console.log(`2ième requête asynchrone réussie résultat= ${x}`)},
            (x)=>{console.log(`2ième requête asynchrone échouée résultat= ${x}`)},
            0.1
        );
    }

    function exo3_0() {
        function asynchrone(resolve,reject,d){
            // simulation d'une requête A asynchrone avec setTimeout
            setTimeout( ()=>{
                let a=Math.random();
                if (a >d ) resolve(a);
                else reject(a)
            }, 500);
        };
        console.log("début des requêtes Asynchrone")




        asynchrone(
            (x)=>{
                console.log(`1ère requête asynchrone réussie résultat= ${x}`);
                asynchrone(
                    (y)=>{
                        console.log(`2ème requête asynchrone réussie résultat= ${y}`);
                        console.log(`sum= ${y}`);
                    },
                    (y)=> {
                        console.log(`2ème requête asynchrone échouée résultat= ${y}`);
                    },
                    0.5
                );
            },
            (x)=> {
                console.log(`1ère requête asynchrone échouée résultat= ${x}`);
            },
            0.5
        );
    }
    
    function exo4() {
        requeteAsynchrone(0.5)
        function requeteAsynchrone (d) {
            return new Promise( function (resolve, reject) {
                console.log("début de la requete Asynchrone")
                let a=Math.random();
                setTimeout( function () {
                    if (a >d ) resolve(`Requete Asynchrone bien terminée le résultat = ${a}`);
                    else reject('Requete Asynchrone mal terminée')
                }, 3000);
                console.log(" requete Asynchrone en cours d'exécution")
            });
        }
    }
    
    function exo5() {

        function requeteAsynchrone (d) {
            return new Promise( function (resolve, reject) {
                console.log("début de la requete Asynchrone")
                var a=Math.random();
                setTimeout( function () {
                    if (a > d ) resolve(a);
                    else reject(' Requete Asynchrone mal terminée')
                }, 3000);
                console.log(" requete Asynchrone en cours d'exécution")
            });
        }


        requeteAsynchrone(0.1)
            .then((x)=>{requeteAsynchrone(0.1) // x résultat de la première requête
                .then((y)=>{requeteAsynchrone(0.1) // y résultat de la deuxième requête
                    .then((z)=>{console.log(`x=${x} y=${y} z=${y} x*y*z=${x*y*z}`)})
                    // z résultat de la troisième requête
                    .catch((z)=>{console.log('Echec R3 ' + z)})
                })
                .catch((y)=>{console.log('Echec R2 ' + y)})
            })
            .catch((x)=>{console.log('Echec R1 ' + x)});
    }
</script>

